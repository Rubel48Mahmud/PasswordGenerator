<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Password Generator ‚Äî Rubel</title>
  <style>
    :root {
      --bg: #0f172a;
      --card-bg: #1e293b;
      --text: #f1f5f9;
      --btn-bg: #06b6d4;
      --btn-text: #022;
      --secondary-bg: #334155;
      --secondary-text: #f1f5f9;
    }
    body.light {
      --bg: #f1f5f9;
      --card-bg: #ffffff;
      --text: #0f172a;
      --btn-bg: #06b6d4;
      --btn-text: #fff;
      --secondary-bg: #e2e8f0;
      --secondary-text: #0f172a;
    }

    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: flex-start; /* ‡¶ï‡¶æ‡¶∞‡ßç‡¶° ‡¶â‡¶™‡¶∞‡ßá ‡¶§‡ßã‡¶≤‡¶æ */
      justify-content: center;
      padding: 20px;
      padding-top: 40px; /* ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶∏‡ßç‡¶™‡ßá‡¶∏ ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶ü‡¶æ */
      transition: 0.3s;
    }

    .card {
      width: 100%;
      max-width: 420px;
      background: var(--card-bg);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
      transition: 0.3s;
    }

    h1 {
      margin: 0 0 16px 0;
      font-size: 20px;
      text-align: center;
    }

    .output {
      width: 93%;
      padding: 12px;
      border-radius: 8px;
      background: var(--bg);
      border: 1px solid var(--secondary-bg);
      font-size: 16px;
      overflow-wrap: anywhere;
      text-align: center;
      margin-bottom: 12px;
    }

    .controls {
      margin-top: 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 12px;
    }

    label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
    }

    input[type=checkbox] {
      width: 16px;
      height: 16px;
    }

    .range-wrap {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 8px 0;
    }

    input[type=range] {
      flex: 1;
    }

    .btns {
      display: flex;
      gap: 8px;
    }

    button {
      flex: 1;
      background: var(--btn-bg);
      border: none;
      color: var(--btn-text);
      font-weight: 600;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }

    button.secondary {
      background: var(--secondary-bg);
      color: var(--secondary-text);
    }

    .pm {
      background: var(--secondary-bg);
      color: var(--secondary-text);
      width: 28px;
      height: 28px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    /* Small toggle button top-right */
    #modeToggle {
      position: fixed;
      top: 12px;
      right: 12px;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: none;
      background: var(--secondary-bg);
      color: var(--secondary-text);
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: 0.3s;
    }

    /* Strength Meter */
    .strength-wrap {
      margin-top: 12px;
    }

    .strength-bar {
      width: 100%;
      height: 8px;
      border-radius: 6px;
      background: #334155;
      overflow: hidden;
    }

    .strength-fill {
      height: 100%;
      width: 0;
      background: red;
      transition: 0.3s;
    }

    .strength-text {
      font-size: 13px;
      margin-top: 4px;
      text-align: center;
    }
  </style>
</head>
<body>
  <!-- toggle button -->
  <button id="modeToggle">‚òÄÔ∏è</button>

  <main class="card">
    <h1>Password Generator</h1>
    <div id="passwordOutput" class="output">Click "Generate" to create a password</div>

    <!-- Strength Meter -->
    <div class="strength-wrap">
      <div class="strength-bar"><div id="strengthFill" class="strength-fill"></div></div>
      <div id="strengthText" class="strength-text">Strength: N/A</div>
    </div>

    <div class="options">
      <label><input id="lowercase" type="checkbox" checked /> Lowercase (a-z)</label>
      <label><input id="uppercase" type="checkbox" checked /> Uppercase (A-Z)</label>
      <label><input id="numbers" type="checkbox" checked /> Numbers (0-9)</label>
      <label><input id="symbols" type="checkbox" checked /> Symbols (!@#$...)</label>
    </div>

    <div class="range-wrap">
      <button class="pm" id="minusBtn">-</button>
      <input id="lengthRange" type="range" min="4" max="64" value="8" />
      <button class="pm" id="plusBtn">+</button>
      <span id="lenLabel">16</span>
    </div>

    <div class="btns">
      <button id="generateBtn">Generate</button>
      <button id="copyBtn" class="secondary">Copy</button>
    </div>
  </main>

  <script>
    const sets = {
      lowercase: 'abcdefghijklmnopqrstuvwxyz',
      uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
      numbers: '0123456789',
      symbols: '!@#$%^&*()_+-=[]{}|<>/?~'
    };

    const out = document.getElementById('passwordOutput');
    const lenRange = document.getElementById('lengthRange');
    const lenLabel = document.getElementById('lenLabel');
    const generateBtn = document.getElementById('generateBtn');
    const copyBtn = document.getElementById('copyBtn');
    const chkLower = document.getElementById('lowercase');
    const chkUpper = document.getElementById('uppercase');
    const chkNum = document.getElementById('numbers');
    const chkSym = document.getElementById('symbols');
    const plusBtn = document.getElementById('plusBtn');
    const minusBtn = document.getElementById('minusBtn');
    const modeToggle = document.getElementById('modeToggle');

    const strengthFill = document.getElementById("strengthFill");
    const strengthText = document.getElementById("strengthText");

    lenLabel.textContent = lenRange.value;
    lenRange.addEventListener('input', () => {
      lenLabel.textContent = lenRange.value;
    });

    plusBtn.addEventListener('click', () => {
      let val = parseInt(lenRange.value);
      if (val < parseInt(lenRange.max)) {
        lenRange.value = val + 1;
        lenLabel.textContent = lenRange.value;
      }
    });

    minusBtn.addEventListener('click', () => {
      let val = parseInt(lenRange.value);
      if (val > parseInt(lenRange.min)) {
        lenRange.value = val - 1;
        lenLabel.textContent = lenRange.value;
      }
    });

    function generatePassword(len){
      let available = '';
      if (chkLower.checked) available += sets.lowercase;
      if (chkUpper.checked) available += sets.uppercase;
      if (chkNum.checked) available += sets.numbers;
      if (chkSym.checked) available += sets.symbols;
      if (!available) return '';

      let result = '';
      for (let i=0;i<len;i++) result += randomChar(available);
      return result;
    }

    function randomChar(str){
      const i = crypto.getRandomValues(new Uint32Array(1))[0] % str.length;
      return str.charAt(i);
    }

    function checkStrength(pw){
      let score = 0;
      if (pw.length >= 8) score++;
      if (/[A-Z]/.test(pw)) score++;
      if (/[0-9]/.test(pw)) score++;
      if (/[^A-Za-z0-9]/.test(pw)) score++;
      if (pw.length >= 12) score++;

      let strength = "Weak";
      let color = "red";
      let width = "20%";

      if (score >= 4) { strength = "Strong"; color="limegreen"; width="100%"; }
      else if (score == 3) { strength = "Medium"; color="orange"; width="60%"; }
      else if (score == 2) { strength = "Fair"; color="yellow"; width="40%"; }

      strengthFill.style.width = width;
      strengthFill.style.background = color;
      strengthText.textContent = "Strength: " + strength;
    }

    generateBtn.addEventListener('click', () => {
      const len = Number(lenRange.value);
      const pw = generatePassword(len) || 'Select at least one set!';
      out.textContent = pw;
      if (!pw.includes("Select")) checkStrength(pw);
    });

    async function copyCurrent(){
      const text = out.textContent;
      if (!text || text.includes('Select at least')) return;
      try {
        await navigator.clipboard.writeText(text);
        copyBtn.textContent = 'Copied!';
        setTimeout(()=>{ copyBtn.textContent = 'Copy'; }, 1200);
      } catch(e) {
        const temp = document.createElement("textarea");
        temp.value = text;
        document.body.appendChild(temp);
        temp.select();
        try {
          document.execCommand("copy");
          copyBtn.textContent = 'Copied!';
          setTimeout(()=>{ copyBtn.textContent = 'Copy'; }, 1200);
        } catch(err) {
          alert("Copy failed.");
        }
        document.body.removeChild(temp);
      }
    }
    copyBtn.addEventListener('click', copyCurrent);

    modeToggle.addEventListener('click', () => {
      document.body.classList.toggle('light');
      modeToggle.textContent = document.body.classList.contains('light') ? "üåô" : "‚òÄÔ∏è";
    });
  </script>
</body>
</html>
